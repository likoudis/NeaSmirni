<!DOCTYPE html>
<html>
<head>
    <title></title>
    <meta charset="utf-8" />
    <link href="kendo/styles/kendo.mobile.all.min.css" rel="stylesheet" />
    <link href="styles/main.css" rel="stylesheet" />

    <script src="cordova.js"></script>
    <script src="kendo/js/jquery.min.js"></script>
    <script src="kendo/js/kendo.mobile.min.js"></script>
	<script src="https://maps.googleapis.com/maps/api/js?sensor=true"></script>

	<script src="scripts/location.js"></script>
	<script src="scripts/app.js"></script>
	<script src="scripts/i-headers.js"></script>
	<script src="scripts/i-details.js"></script>
	<script src="scripts/i-notes.js"></script>
	<script src="scripts/i-history.js"></script>
	<script src="scripts/i-snap.js"></script>

	<style>
        html .km-wp-light .km-content,
        html .km-wp-light .km-button,
        html .km-wp-light .km-navbar,
        html .km-wp-light .km-detail,
        html .km-wp-light *:not(.k-label) > input:not(.k-input),
        html .km-wp-light .k-dropdown,
        html .km-wp-light *:not(.k-label) > textarea,
        html .km-wp-light *:not(.k-label) > select {
            background: #fff;
        }
    </style>
</head>
<body>
    <!--Welcome-->
	<div id="view-welcome"
        data-role="view"
        data-title="Welcome">

        <div class="view-content">
            <h1>Welcome to V1 of 7-Aug-2014!</h1>
            <p>
                This is the Welcome page.
            </p>
            <div class="img"></div>
			<div style="text-align:center; margin: 10px">
            	<a id="openHomePage" 
					data-role="button"
					data-bind="visible: isDeviceValid"
					href="#drawer-inspxions">
					Open Inspections
            	</a>
			</div>
			<div>
	        	<a id="skin-change" data-role="button" data-align="right" data-click="app.changeSkin">Native</a>
			</div>
			<div id="no-host" data-bind="invisible: isDeviceValid">
				<label for="hostName"> There is no connection or the server URL is invalid:
					<a style="float:right" id="submitbutton" data-role="button" data-click="app.checkValidDevice">Enter</a>
					<input style="float:right" type="text" id="hostName" data-bind="value: hostName">
				</label>
            </div>
			Device ID: <span id="loginDeviceId" data-bind="text: deviceId"> </span>
        </div>
    </div>

	<!--Left drawer-->
	<!-- map should not be included here, if it should not respond to swipe -->
	<div data-role="drawer" id="left-drawer" data-position="left"
		data-views="[
		'drawer-inspxions','drawer-filter','drawer-map','drawer-sync','drawer-settings',
		'drawer-snap','drawer-report','drawer-email',
		'inspx-details','inspx-notes', 'inspx-hist']"
		style="width: 290px"> 
		<ul data-role="listview" data-type="flat">
			<li data-icon="home">     <a data-transition="none" href="#view-welcome">Home</a></li>
			<li data-icon="featured"> <a data-transition="none" href="#drawer-inspxions?filter=all">All Inspections</a></li>
			<li data-icon="featured"> <a data-transition="none" href="#drawer-inspxions?filter=today">Today's Inspections</a></li>
			<li data-icon="featured"> <a data-transition="none" href="#drawer-inspxions?filter=yesterday">Yesterday's Inspections</a></li>
			<li data-icon="featured"> <a data-transition="none" href="#drawer-inspxions?filter=thisWeek">This Week's Inspections</a></li>
			<li data-icon="featured"> <a data-transition="none" href="#drawer-inspxions?filter=lastWeek">Last Week's Inspections</a></li>
			<!--li data-icon="featured"> <a data-transition="none" href="#drawer-filter">Inspection Filter</a></li -->
			<!--li data-icon="camera">   <a data-transition="none" href="#drawer-pixurs">Pictures</a></li -->
			<li data-icon="globe">    <a data-transition="none" href="#drawer-map"   >Map</a></li>
			<li></li>
			<li data-icon="downloads"><a data-transition="none" href="#drawer-sync"    >Synchronize</a></li>
			<li data-icon="settings"> <a data-transition="none" href="#drawer-settings" >Settings</a></li>
		</ul>
	</div>
	
	<!--Right drawer 4 inspx lists-->
	<!-- map should not be included here, if it should not respond to swipe -->
	<div data-role="drawer" id="right-drawer0" data-position="right"
		data-views="['drawer-inspxions','drawer-filter']"
		style="width: 200px">
		<ul data-role="listview" data-type="flat">
			<li data-icon="camera">   <a data-transition="none" href="#drawer-snap"    >Snap</a> </li>
			<li data-icon="organize"> <a data-transition="none" href="#drawer-report"  >Report</a></li>
			<li data-icon="share">    <a data-transition="none" href="#drawer-email"   >E-mail</a></li>
		</ul>
	</div>
	
	<!--Right drawer 4 single inspx-->
	<div data-role="drawer" id="right-drawer1" data-position="right"
		data-views="[
		'inspx-details','inspx-notes','drawer-pixurs','drawer-addinspx', 'inspx-hist']"
		style="width: 200px">
		<ul data-role="listview" data-type="inset" >
			<li data-icon="featured" ><a data-transition="none" data-rel="modalview" href="#modal-psfc"  data-role="button">Assessment</a> </li>
			<li data-icon="compose">  <a data-transition="none" href="#drawer-addinspx">Add Inspection</a></li>
			<li data-icon="info"     ><a data-transition="none" href="#inspx-details" >Details</a></li>
			<li data-icon="bookmarks"><a data-transition="none" href="#inspx-notes"   >Notes</a></li>
			<li data-icon="camera">   <a data-transition="none" href="#drawer-pixurs">Pictures</a></li>
			<li></li>
			<li data-icon="camera">   <a data-transition="none" href="#drawer-snap"   >Snap</a> </li>
			<li data-icon="organize"> <a data-transition="none" href="#drawer-report" >Report</a></li>
			<li data-icon="share"    ><a data-transition="none" href="#drawer-email"  >E-mail</a></li>
		</ul>
	</div>
	
	<!--Drawer Layout 4 not-leaf views-->
	<div data-role="layout" data-id="drawer-layout">
		<header data-role="header">
			<div data-role="navbar" id="inspxListViewNavBar">
				<a data-role="button" data-align="left" data-rel="drawer" href="#left-drawer" data-icon="drawer-button">Lists</a>
				<span data-role="view-title"></span>
				<a data-role="button" data-align="right" data-rel="drawer" href="#right-drawer0" data-icon="share">Actions</a>
				<a data-role="backbutton" data-align="right">Back</a>
			</div>
		</header>
	</div>

	<!--Drawer Layout 4 leaf views-->
	<div data-role="layout" data-id="drawer-layout1">
		<header data-role="header">
			<div data-role="navbar">
				<a data-role="button" data-align="left" data-rel="drawer" href="#left-drawer" data-icon="drawer-button">Lists</a>
				<span data-role="view-title"></span>
				<a data-role="button" data-align="right" data-rel="drawer" href="#right-drawer1" data-icon="share">Actions</a>
				<a data-role="backbutton" data-align="right">Back</a>
			</div>
		</header>
	</div>

	<!--Drawer Layout 4 leaf views-->
	<div data-role="layout" data-id="drawer-layout2">
		<header data-role="header">
			<div data-role="navbar">
				<a data-role="button" data-align="left" data-rel="drawer" href="#left-drawer" data-icon="drawer-button">Lists</a>
				<span data-role="view-title"></span>
				<a data-role="backbutton" data-align="right">Back</a>
			</div>
		</header>
	</div>

	<!--Inspection headers-->
	<div id="drawer-inspxions" data-role="view" data-layout="drawer-layout" data-title="All Inspections"
		data-init="app.mobileListViewFiltering" 
		data-show="app.onInspectionShow">
		<!-- div class="map-search-wrap">
			<button id="map-navigate-home"></button>
			<form onsubmit="return false;">
				<input id="map-address" type="search" placeholder="Address" />
				<input class="map-search" type="submit" value="" />
			</form>
		</div -->
		<div id="headerListScroller" data-role="scroller"
			style="width:100%">
		    <ul id="filterList" class="filterList" data-role="listview">
		    </ul>
        </div>
	</div>
	<script type="text/x-kendo-template" id="inspx-template">
		<div >
			<div class="item-thumb">
				<img class="loading-thumb" src="styles/images/IconLogoOrange.jpg" />
			</div>
			<div class="item-summary">
				<h3 class="time">#= InspectionDate === null ? "No date" : new Date(InspectionDate).toDateString() #</h3>
				<h3>#= PropertyAddress #</h3><p>No: #= InspectionNo #</p>
				<p>#= InspectionType #</p>
			</div>
		<a class="item-link" href="\#inspx-notes" onclick="return app.setAndReadFor(#=InspectionId#);"> &gt;
		</a>
		</div>
	</script>

	<!--Inspection Notes-->
	<div id="inspx-notes" data-title="Inspection Notes" data-role="view" data-layout="drawer-layout1"
		data-show="app.onNotesShow">
		<div data-role="scroller" style="height: 30%">
			<form>
				<div style="display:inline-block; text-align:top">
					<p>New Note</p>
					<div data-role="button" data-click="app.onAddNote">Append</div>
                </div>
				<textarea id="newNoteText" rows="8" placeholder="Your comments here..."
					style="width:75%; padding: 3px; border: 1px solid"></textarea>
			</form>
		</div>
		<div data-role="scroller" style="height: 700px">
			<ul id="i-notes-section" data-role="listview" data-template="notes-template" data-source="app.notesDataSource"
				 data-auto-bind="false">
			</ul>
		</div>
	</div>
	<script type="text/x-kendo-template" id="notes-template">
		<div class="item-summary">
		<h3 class="time"> #= CreateDate === null ? "No date" : new Date(CreateDate).toDateString()  # </h3>
		<p> #= Note || "&lt;no notes&gt;" # </p>
		</div>
	</script>

	<!--Inspection Details-->
	<div id="inspx-details" data-title="Inspection Details" data-role="view" data-layout="drawer-layout1" 
		data-model="app.detailsViewModel" data-before-show="app.onDetailsShow" >
		<ul id="i-detail-section" data-role="listview"  data-template="details-section-template" data-bind="source: detailsGroupedList"
			data-auto-bind="true">
		</ul>
	</div>
	<script type="text/x-kendo-template" id="details-section-template">
		# if (header !== "History") { #
			<h2>#: header #</h2>
			<ul id="i-detail-list" data-role="listview"  data-template="details-template" data-bind="source: fields">
			</ul>
		# } else { #
			<a  href="\#inspx-hist">
				<h2> #: header # </h2>
			</a>
		# } #
	</script>
	<script type="text/x-kendo-template" id="details-template">
		<span style="font-weight: bold">#= desc # </span>
		<span style="float:right">#= typeof(ix) === "function" ? ix() : app.detailsViewModel.detailsDataSource.data()[0][ix]# </span>
	</script>

	<!--Inspection History-->
	<div id="inspx-hist" data-role="view" data-layout="drawer-layout" data-title="Past Inspections"
		data-show="app.onHistoryShow">
		<div class="map-search-wrap">
			<button id="map-navigate-home"></button>
			<form onsubmit="return false;">
				<input id="map-address" type="search" placeholder="Address" />
				<input class="map-search" type="submit" value="" />
			</form>
		</div>
		<ul class="filterList" data-role="listview" data-template="inspx-template" data-source="app.historyDataSource">
		</ul>
	</div>

	<style>
		.i-detail-list-data {
			float:right;
			margin-right: 20px;
			font-weight: bold;
        }
    </style>

	<!--Assess (pass/fail)-->
	<div data-role="modalview" id="modal-psfc" data-width="400" data-height="430" data-modal="false">
		<div data-role="header">
			<div data-role="navbar">
				<span>Assessment</span>
			</div>
		</div>

		<ul data-role="listview">
			<li style="text-align:center"> Date: today</li>
			<li data-role="button"><span data-icon="featured" >Pass</span></li>
			<li data-role="button"><span data-icon="downloads" >Fail</span></li>
			<li data-role="button"><span data-icon="more" >Conditional</span></li>
		</ul>

		<div data-role="footer">
			<div data-role="navbar">
				<a id="cancel-login" data-click="app.closeAssessModalView" data-align="right" data-role="button">Cancel</a>
			</div>
		</div>

	</div>
 
	<!--Filter-->
	<div data-role="view" data-title="Inspection List Filter" id="drawer-filter" data-layout="drawer-layout" >
		<label>
	        From-date:
 			<input type="date" value="2014-01-22" />
		</label>
		<label>
    	    To-date:
 			<input type="date" value="2014-03-22" />
		</label>
		<label>Inspection Status
			<select  id="dropdown">
				<option value="All">All</option>
				<option value="Pass">Pass</option>
				<option value="Fail">Fail</option>
				<option value="Conditional">Conditional</option>
			</select>
		</label>
		<ul class="filterList" data-role="listview" data-template="inspx-template" data-source="inspxDataList">
		</ul>
    </div>

	<!--Pictures-->
	<div data-role="view" data-title="Inspection Pictures" id="drawer-pixurs" data-layout="drawer-layout2" >
		<ul id="gallery-listview"
			data-role="listview" 
			data-template="pix-list-template" 
			data-source="galleryDataSource"
			data-click="showDetail">
		</ul>
	</div>
	<script>
		var galleryDataSource = new kendo.data.DataSource({
			transport: {
				read: {
					url: function() {return app.settings.getInspxPicturesURL()}
					, data: {
						deviceid: function () { return app.settings.deviceId}
						, inspectionId: function () { return app.currentInspectionId}
					}
				}
			}
				
			//data: [
			//{fname:"/storage/sdcard0/MyInspections/000000000_000.jpg"},
			//{fname:"/storage/sdcard0/MyInspections/000000000_001.jpg"},
			//{fname:"/storage/sdcard0/MyInspections/000000000_002.jpg"},
			//{fname:"/storage/sdcard0/MyInspections/000000000_003.jpg"}
			//]
		})
    </script>
	<script type="text/x-kendo-template" id="pix-list-template">
		<p><img height="100" width="133" src="#= fname #">   <span class="idetail-d"> #= fname#   </span></p>
		<div data-role="button" data-click="app.pixUpload" data-image="#=fname#"> Upload
		</div>
    </script>

	<!--Map-->
	<div data-role="view" data-layout="drawer-layout2" id="drawer-map" data-title="Map"
		data-init="app.locationService.initLocation"
		data-show="app.locationService.show"
		data-hide="app.locationService.hide"
		data-model="app.locationService.viewModel"
		data-stretch="true">

		<div id="no-map" data-bind="invisible: isGoogleMapsInitialized">
			This view requires internet connection to display the map.
		</div>
		<div>
			<!--div class="map-search-wrap">
				<div>
					<button id="map-navigate-home" class="map-tools-button home" data-bind="click: onNavigateHome"></button>
    				<input id="map-address" type="search" class="map-tools-input" data-bind="value: address" placeholder="Address" />
					<button class="map-tools-button search" data-bind="click: onSearchAddress"></button>
				</div>
			</div-->
			<ul id="listview-permitsToday" 
				data-role="listview"
				data-bind="source: permitsTodayDataSource"
				data-template="location-inspections-template">
			</ul>
			<p id="map-canvas"
				data-bind="visible: isGoogleMapsInitialized">
			</p>
		</div>
	</div>

	<!--Inspection Address List template-->
	<script type="text/x-kendo-tmpl" id="location-inspections-template">
		<div>
			#=address#
			<a 
				data-role="detailbutton" data-icon="contactadd"
				data-bind="click:onInspectionSelect, invisible:inspectionAddressOnMap">
				<span style="visibility:hidden">#=id#</span>
			</a>
			<a 
				data-role="detailbutton" data-icon="rowdelete"
				data-bind="click:onInspectionSelect, visible:inspectionAddressOnMap">
				<span style="visibility:hidden">#=id#</span>
			</a>
		</div>
	</script>

	<!--Settings-->
	<div data-role="view" data-layout="drawer-layout2" id="drawer-settings" data-title="Settings" data-use-native-scrolling="true">
		<form action="javascript:history.back()">
			<ul data-role="listview" data-style="inset" id="settingsListView">
				<li>
					<label>Service host URL: 
						<input type="url" placeholder="http://server:port/service/program(?.....)"
							data-bind="value:serviceHostURL"
							value="http://dctlt063:8000/directit.permitting">
					</label>
                </li>
				<li>
					<label>Service host URL: 
						<input type="url" placeholder="http://server:port/service/program(?.....)"
							data-bind="value:serviceHostURL"
							value="http://dctlt063:8000/directit.permitting">
					</label>
                </li>
				<li>
					<label>Service host URL:</label>
						<input type="url" placeholder="http://server:port/service/program(?.....)"
							data-bind="value:serviceHostURL"
							value="http://dctlt063:8000/directit.permitting">
                </li>
				<li>
					<label>Service host URL: 
						<input type="url" placeholder="http://server:port/service/program(?.....)"
							data-bind="value:serviceHostURL"
							value="http://dctlt063:8000/directit.permitting">
					</label>
                </li>
			
			</ul>
        </form>
	</div>
	
	<!--Snap-->
	<div data-role="view" data-layout="drawer-layout2" id="drawer-snap" data-title="Take Pictures">
		Add a picture to the current inspection
		<a data-role="button" data-click="app.onSnapShow">
			Snap
        </a>
		<div>
			<img height="100" width="133" id="snap-thumb"> <span id="snap-fname"></span>
        </div>
	</div>
	
	<!--Report-->
	<div data-role="view" data-layout="drawer-layout2" id="drawer-report" data-title="Reports" data-show="app.renderReport">
		<div data-role="scroller" id="scroller-report">
		</div>
		<a  style="position:fixed; bottom: 40px; right: 30px" data-role="button">
			Print
        </a>
	</div>

	<!--Email-->
	<div data-role="view" data-layout="drawer-layout2" id="drawer-email" data-title="E-mail">
		<div data-role="scroller">
			<form>
				<ul data-role="listview" data-style="inset">
					<li>
						<label>To:
							<input type="email" style="width:85%; text-align:left" value="someone@domain.ca" />
						</label>
					</li>
					<li>
						<label>Subject:
							<input type="text" style="width:85%; text-align:left" value="Re: Inspection ###########" />
						</label>
					</li>
					<li>
						<label>Message
							<textarea placeholder="Enter your comments here..." 
								rows="10" cols="60" style="width:85%; padding: 3px; border: 1px solid">
                            </textarea>
						</label>
					</li>
					<li>
						<p>Attachment: /storage/sdcard0/My_Inspections/###########.jpg</p>
						<p>Attachment: /storage/sdcard0/My_Inspections/###########.rpt</p>
						<p>Attachment: /storage/sdcard0/My_Inspections/###########.eml</p>
                    </li>
				</ul>
			</form>
		</div>
		<a style="position:fixed; bottom: 40px; right: 30px" data-role="button">
			Submit
        </a>
	</div>
	
	<!--Add Inspection-->
	<div data-role="view" data-layout="drawer-layout2" id="drawer-addinspx" data-title="Add an Inspection">
	</div>
	
	<!--Synchronize-->
	<div data-role="view" data-layout="drawer-layout2" id="drawer-sync" data-title="Synch with Server">
	</div>
</body>
</html>