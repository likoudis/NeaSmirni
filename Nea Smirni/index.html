<!DOCTYPE html>
<html>
<head>
    <title></title>
    <meta charset="utf-8" />
    <link href="kendo/styles/kendo.mobile.all.min.css" rel="stylesheet" />
    <link href="styles/main.css" rel="stylesheet" />

    <script src="cordova.js"></script>
    <script src="kendo/js/jquery.min.js"></script>
    <script src="kendo/js/kendo.mobile.min.js"></script>
	<script src="https://maps.googleapis.com/maps/api/js?sensor=true"></script>

	<script src="scripts/location.js"></script>
	<script src="scripts/app.js"></script>

	<style>
        html .km-wp-light .km-content,
        html .km-wp-light .km-button,
        html .km-wp-light .km-navbar,
        html .km-wp-light .km-detail,
        html .km-wp-light *:not(.k-label) > input:not(.k-input),
        html .km-wp-light .k-dropdown,
        html .km-wp-light *:not(.k-label) > textarea,
        html .km-wp-light *:not(.k-label) > select {
            background: #fff;
        }
    </style>
</head>
<body>
    <!--Welcome-->
	<div id="view-welcome"
        data-role="view"
        data-title="Welcome">

        <div class="view-content">
            <h1>Welcome!</h1>
            <a id="openLoginModalView" 
				data-role="button"
				data-rel="modalview" 
				href="#loginModalView"
				style="margin: 5%">
				Login
            </a>
            <p>
                This is the Welcome page.
            </p>
            <div class="img"></div>
			<div style="text-align:center; margin: 10px">
            	<a id="openHomePage" 
					data-role="button"
					data-enable="false"
					href="#drawer-inspxions">
					Open Inspections
            	</a>
			</div>
			<div>
	        	<a id="skin-change" data-role="button" data-align="right" data-click="app.changeSkin">Native</a>
				<a id="clearLocalStorage" data-role="button" data-align="right" data-click="app.clearLS">Clear LS</a>
			</div>
			<div id="no-host" data-bind="invisible: isHostConnected">
					<label for="hostName"> Host name not setup or invalid, please re-enter:
						<input type="text" id="hostName" data-bind="value: hostName">
						<a id="submitbutton" data-role="button" data-click="app.getHostName">Enter</a>
					</label>
            </div>
			Device ID: <span id="loginDeviceId" data-bind="text: deviceId"> </span>
        </div>
    </div>

    <!--Login-->
	<div id="loginModalView" data-role="modalview" data-width="300" data-height="250" data-modal="false">
        <div data-role="header">
            <div data-role="navbar">
				<span>Login</span>
				<a id="cancel-login" data-click="app.closeLoginModalView" data-role="button" data-align="right">Cancel</a>
			</div>
        </div>    
        <ul data-role="listview" data-style="inset">
            <li>
                <label>Username
                    <input type="text" id="username" value="username" />
                </label>
            </li>
            <li>
                <label>Password
                    <input type="password" id="password" value="password" />
                </label>
            </li>
        </ul>
		<div style="text-align:center">
    	    <a data-role="button" data-rel="modalview" data-click="app.closeLoginModalView">Login</a>
		</div>
    </div>

	<!--Left drawer-->
	<!-- map should not be included here, if it should not respond to swipe -->
	<div data-role="drawer" id="left-drawer" data-position="left"
		data-views="[
		'drawer-inspxions','drawer-filter','drawer-pixurs','drawer-map','drawer-sync','drawer-settings',
		'drawer-snap','drawer-report','drawer-email',
		'inspx-details','inspx-notes']"
		style="width: 290px"> 
		<ul data-role="listview" data-type="flat">
			<li data-icon="home">     <a data-transition="none" href="#view-welcome">Home</a></li>
			<li data-icon="featured"> <a data-transition="none" href="#drawer-inspxions?filter=all">All Inspections</a></li>
			<li data-icon="featured"> <a data-transition="none" href="#drawer-inspxions?filter=today">Today's Inspections</a></li>
			<li data-icon="featured"> <a data-transition="none" href="#drawer-inspxions?filter=weeks">This Week's Inspections</a></li>
			<li data-icon="featured"> <a data-transition="none" href="#drawer-filter">Inspection Filter</a></li>
			<li data-icon="camera">   <a data-transition="none" href="#drawer-pixurs"   >Pictures</a></li>
			<li data-icon="globe">    <a data-transition="none" href="#drawer-map"      >Map</a></li>
			<li></li>
			<li data-icon="downloads"><a data-transition="none" href="#drawer-sync"    >Synchronize</a></li>
			<li data-icon="settings"> <a data-transition="none" href="#drawer-settings" >Settings</a></li>
		</ul>
	</div>
	
	<!--Right drawer 4 inspx lists-->
	<!-- map should not be included here, if it should not respond to swipe -->
	<div data-role="drawer" id="right-drawer0" data-position="right"
		data-views="['drawer-inspxions','drawer-filter']"
		style="width: 200px">
		<ul data-role="listview" data-type="flat">
			<li data-icon="camera">   <a data-transition="none" href="#drawer-snap"    >Smile</a> </li>
			<li data-icon="organize"> <a data-transition="none" href="#drawer-report"  >Report</a></li>
			<li data-icon="share">    <a data-transition="none" href="#drawer-email"   >E-mail</a></li>
		</ul>
	</div>
	
	<!--Right drawer 4 single inspx-->
	<div data-role="drawer" id="right-drawer1" data-position="right"
		data-views="[
		'inspx-details','inspx-notes','drawer-addinspx']"
		style="width: 200px">
		<ul data-role="listview" data-type="inset" >
			<li data-icon="featured" ><a data-transition="none" data-rel="modalview" href="#modal-psfc"  data-role="button">Assessment</a> </li>
			<li data-icon="compose">  <a data-transition="none" href="#drawer-addinspx">Add Inspection</a></li>
			<li data-icon="info"     ><a data-transition="none" href="#inspx-details" >Details</a></li>
			<li data-icon="bookmarks"><a data-transition="none" href="#inspx-notes"   >Notes</a></li>
			<li></li>
			<li data-icon="camera">   <a data-transition="none" href="#drawer-snap"   >Smile</a> </li>
			<li data-icon="organize"> <a data-transition="none" href="#drawer-report" >Report</a></li>
			<li data-icon="share"    ><a data-transition="none" href="#drawer-email"  >E-mail</a></li>
		</ul>
	</div>
	
	<!--Drawer Layout 4 not-leaf views-->
	<div data-role="layout" data-id="drawer-layout">
		<header data-role="header">
			<div data-role="navbar" id="inspxListViewNavBar">
				<a data-role="button" data-align="left" data-rel="drawer" href="#left-drawer" data-icon="drawer-button">Lists</a>
				<span data-role="view-title"></span>
				<a data-role="button" data-align="right" data-rel="drawer" href="#right-drawer1" data-icon="share">Actions</a>    
			</div>
		</header>
	</div>

	<!--Drawer Layout 4 leaf views-->
	<div data-role="layout" data-id="drawer-layout1">
		<header data-role="header">
			<div data-role="navbar">
				<a data-role="button" data-align="left" data-rel="drawer" href="#left-drawer" data-icon="drawer-button">Lists</a>
				<span data-role="view-title"></span>
				<a data-role="backbutton" data-align="right">Back</a>
			</div>
		</header>
	</div>

	<!--Inspections-->
	<div data-role="view" data-layout="drawer-layout" id="drawer-inspxions" data-title="All Inspections"
		data-show="app.onInspectionShow">
		<div id="map-search-wrap">
			<button id="map-navigate-home"></button>
			<form onsubmit="return false;">
				<input id="map-address" type="search" placeholder="Address" />
				<input id="map-search" type="submit" value="" />
			</form>
		</div>
		<ul class="filterList" data-role="listview" data-template="inspx-template" data-source="app.inspxDataList">
		</ul>
	</div>
	<script type="text/x-kendo-template" id="inspx-template">
		<div >
			<div class="item-thumb">
				<img class="loading-thumb" src="styles/images/My_municipality.png" />
			</div>
			<div class="item-summary">
				<h3 class="time">#: InspectionDate #</h3> <h3>#: PropertyAddress #</h3>
				<p>#: InspectionType #</p>
			</div>
		<a class="item-link" href="\#inspx-notes" >&nbsp;&nbsp;&nbsp;&nbsp;
		</a>
		</div>
	</script>
	
	<!--Inspection Notes-->
	<div id="inspx-notes" data-title="Inspection Notes" data-role="view" data-layout="drawer-layout">
		<div data-role="scroller" style="height: 30%">
			<form>
				<div style="display:inline-block; text-align:top">
					<p>New Note</p>
					<div data-role="button">Append</div>
                </div>
				<textarea rows="8" style="width:75%; padding: 3px; border: 1px solid">Enter you comments here,
123456789112345678921234567893123456789412345678951234567896
and this is line 3
4,
5,
6,
7,
8...
</textarea>
			</form>
		</div>
		<div data-role="scroller" style="height: 300px">
			<ul class="filterList" data-role="listview" data-template="notes-template" data-source="notesDataSource">
			</ul>
		</div>
	</div>
	<script>
		var notesDataSource = new kendo.data.DataSource ({
			transport: {
				read: {
					url: "data/MyInspections/temp/inspection00000.xml",
					dataType: "xml"
                }
            },
			schema: {
				type: "xml",
				data: "/Inspection/PermitInspections/PermitInspection",
				model: {
					fields: {
						date:	   "Inspected/text()",
						note:	   "Notes/text()"
                    }
                }
            }
        })
		notesDataSource.fetch();
    </script>
	<script type="text/x-kendo-template" id="notes-template">

			<h3 class="time"> #= new Date(date).toUTCString().replace("GMT","") # </h3>
			<p> #= note === undefined? "&lt;no notes&gt;" : note # </p>
	</script>

	<!--Inspection details-->
	<div id="inspx-details" data-title="Inspection Details" data-role="view" data-layout="drawer-layout">
		<ul id="i-detail-list" data-role="listview" data-style="inset" data-type="group">
			<li>Inspection Information
				<ul>
					<li><span>Number        </span><span class="i-detail-list-data">000020958   </span></li>
					<li><span>Assigned To   </span><span class="i-detail-list-data">BUSBY, CHRIS</span></li>
					<li><span>Type          </span><span class="i-detail-list-data">Final       </span></li>
					<li><span>Date Requested</span><span class="i-detail-list-data">28/11/2013  </span></li>
                </ul>
            </li>
			<li>Property Information
				<ul>
					<li><a><span>Owner            </span><span class="i-detail-list-data">MILLS BRUCE BEVERLEY                            </span></a></li>
					<li>   <span>Legal Description</span><span class="i-detail-list-data">PLAN M73 PT LOT 2 PCL 7253;S/S RP 42R4637 PART 4</span>   </li>
					<li>   <span>Rol #            </span><span class="i-detail-list-data">49-03-010-001-19000-0000                        </span>   </li>
                </ul>
            </li>
			<li>Building Permit Information
				<ul>
					<li><span>Document # </span><span class="i-detail-list-data">2013-5143                         </span></li>
					<li><span>Type       </span><span class="i-detail-list-data">Residential                       </span></li>
					<li><span>Doc. Date  </span><span class="i-detail-list-data">04/06/2013 07:00:00               </span></li>
					<li><span>Description</span><span class="i-detail-list-data">ENLARGE BEDROOM AND FRONT ENTRANCE</span></li>
                </ul>
            </li>
			<li>Permit Information
				<ul>
					<li>   <span>Construction Type </span><span class="i-detail-list-data">Renovation/Addition    </span>    </li>
					<li>   <span>Current Use       </span><span class="i-detail-list-data">Single Family Residence</span>    </li>
					<li>   <span>Intended Use      </span><span class="i-detail-list-data">Single Family Residence</span>    </li>
					<li>   <span>Conditional Pemit </span><span class="i-detail-list-data">                       </span>    </li>
					<li><a><span>Permit Notes      </span><span class="i-detail-list-data">                       </span></a></li>
					<li><a><span>Permit Inspections</span><span class="i-detail-list-data">                       </span></a></li>
               </ul>
            </li>
        </ul>
	</div>
	<style>
		.i-detail-list-data {
			float:right;
			margin-right: 20px;
			font-weight: bold;
        }
    </style>

	<!--Assess (pass/fail)-->
	<div data-role="modalview" id="modal-psfc" data-width="400" data-height="430" data-modal="false">
		<div data-role="header">
			<div data-role="navbar">
				<span>Assessment</span>
			</div>
		</div>

		<ul data-role="listview">
			<li style="text-align:center"> Date: today</li>
			<li data-role="button"><span data-icon="featured" >Pass</span></li>
			<li data-role="button"><span data-icon="downloads" >Fail</span></li>
			<li data-role="button"><span data-icon="more" >Conditional</span></li>
		</ul>

		<div data-role="footer">
			<div data-role="navbar">
				<a id="cancel-login" data-click="app.closeAssessModalView" data-align="right" data-role="button">Cancel</a>
			</div>
		</div>

	</div>
 
	<!--Filter-->
	<div data-role="view" data-title="Inspection List Filter" id="drawer-filter" data-layout="drawer-layout" >
		<label>
	        From-date:
 			<input type="datetime-local" value="2014-01-22T20:15" />
		</label>
		<label>
    	    To-date:
 			<input type="datetime-local" value="2014-03-22T20:15" />
		</label>
		<label>Inspection Status
			<select  id="dropdown">
				<option value="All">All</option>
				<option value="Pass">Pass</option>
				<option value="Fail">Fail</option>
				<option value="Conditional">Conditional</option>
			</select>
		</label>
		<ul class="filterList" data-role="listview" data-template="inspx-template" data-source="inspxDataList">
		</ul>
    </div>

	<!--Pictures-->
	<div data-role="view" data-title="Inspection Pictures" id="drawer-pixurs" data-layout="drawer-layout1" >
		<ul id="gallery-listview"
			data-role="listview" 
			data-template="pix-list-template" 
			data-source="galleryDataSource"
			data-click="showDetail">
		</ul>
	</div>
	<script>
		var galleryDataSource = new kendo.data.DataSource({
			data: [
			{fname:"/storage/sdcard0/MyInspections/000000000_000.jpg"},
			{fname:"/storage/sdcard0/MyInspections/000000000_001.jpg"},
			{fname:"/storage/sdcard0/MyInspections/000000000_002.jpg"},
			{fname:"/storage/sdcard0/MyInspections/000000000_003.jpg"}
			]
		})
    </script>
	<script type="text/x-kendo-template" id="pix-list-template">
		<p><img height="100" width="100" src="#: fname #">   <span class="idetail-d"> #= fname#   </span></p>
		<a href="mailto:likoudis@hotmail.com?subject=My Inspections">
			Email Me
		</a>
	</script>

	<!--Map-->
	<div data-role="view" data-layout="drawer-layout1" id="drawer-map" data-title="Map"
		data-init="app.locationService.initLocation"
		data-show="app.locationService.show"
		data-hide="app.locationService.hide"
		data-model="app.locationService.viewModel"
		data-stretch="true">

		<div id="no-map" data-bind="invisible: isGoogleMapsInitialized">
			This view requires internet connection to display the map.
		</div>
		<div>
			<div id="map-search-wrap">
				<div>
					<button id="map-navigate-home" class="map-tools-button home" data-bind="click: onNavigateHome"></button>
    				<input id="map-address" type="search" class="map-tools-input" data-bind="value: address" placeholder="Address" />
					<button id="map-search" class="map-tools-button search" data-bind="click: onSearchAddress"></button>
				</div>
			</div>
			<ul id="listview-permitsToday" 
				data-role="listview"
				data-bind="source: permitsTodayDataSource"
				data-template="location-inspections-template">
			</ul>
			<p id="map-canvas"
				data-bind="visible: isGoogleMapsInitialized">
			</p>
		</div>
	</div>

	<!--Inspection Address List template-->
	<script type="text/x-kendo-tmpl" id="location-inspections-template">
		<div>
			#:address#
			<a 
				data-role="detailbutton" data-icon="contactadd"
				data-bind="click:onInspectionSelect, invisible:inspectionAddressOnMap">
				<span style="visibility:hidden">#:id#</span>
			</a>
			<a 
				data-role="detailbutton" data-icon="rowdelete"
				data-bind="click:onInspectionSelect, visible:inspectionAddressOnMap">
				<span style="visibility:hidden">#:id#</span>
			</a>
		</div>
	</script>

	<!--Settings-->
	<div data-role="view" data-layout="drawer-layout" id="drawer-settings" data-title="Settings" data-use-native-scrolling="true">
		<form action="javascript:history.back()">
			<ul data-role="listview" data-style="inset" id="settingsListView">
				<li>
					<label>Service host URL: 
						<input type="url" placeholder="http://server:port/service/program(?.....)"
							data-bind="value:serviceHostURL"
							value="http://dctlt063:8000/directit.permitting">
					</label>
                </li>
			
			</ul>
        </form>
	</div>
	
	<!--Snap-->
	<div data-role="view" data-layout="drawer-layout1" id="drawer-snap" data-title="Take Pictures">
		Add a picture to current inspetion
		<a data-role="button" data-click="app.onSnapShow">
			Snap
        </a>
		<div>
			<img height="100" width="100" id="snap-thumb"> <span id="snap-fname"></span>
        </div>
	</div>
	
	<!--Report-->
	<div data-role="view" data-layout="drawer-layout1" id="drawer-report" data-title="Reports">
		<div data-role="scroller" id="scroller-report">
		</div>
		<a  style="position:fixed; bottom: 40px; right: 30px" data-role="button">
			Print
        </a>
	</div>
	<script>
		var xml = new XMLHttpRequest();
		xml.open("GET", "data/MyInspections/temp/inspection00000.xml",false);
		xml.send("");
		var xsl = new XMLHttpRequest();
		xsl.open("GET", "data/MyInspections/Reports/CheckList.xsl",false);
		xsl.send("");
		xsltProcessor = new XSLTProcessor();
		xsltProcessor.importStylesheet(xsl.responseXML);
		resultDocument = xsltProcessor.transformToFragment(xml.responseXML, document);
		document.getElementById("scroller-report").appendChild(resultDocument);
	 </script>

	<!--Email-->
	<div data-role="view" data-layout="drawer-layout1" id="drawer-email" data-title="E-mail">
		<div data-role="scroller">
			<form>
				<ul data-role="listview" data-style="inset">
					<li>
						<label>To:
							<input type="email" style="width:85%; text-align:left" value="someone@domain.ca" />
						</label>
					</li>
					<li>
						<label>Subject:
							<input type="text" style="width:85%; text-align:left" value="Re: Inspection ###########" />
						</label>
					</li>
					<li>
						<label>Message
							<textarea rows="10" cols="60" style="width:85%; padding: 3px; border: 1px solid">Enter you comments here,
also here
and this is line 3,
4,
5,
6,
7,
8...
</textarea>
						</label>
					</li>
					<li>
						<p>Attachment: /storage/sdcard0/My_Inspections/###########.jpg</p>
						<p>Attachment: /storage/sdcard0/My_Inspections/###########.rpt</p>
						<p>Attachment: /storage/sdcard0/My_Inspections/###########.eml</p>
                    </li>
				</ul>
			</form>
		</div>
		<a style="position:fixed; bottom: 40px; right: 30px" data-role="button">
			Submit
        </a>
	</div>
	
	<!--Add Inspection-->
	<div data-role="view" data-layout="drawer-layout" id="drawer-addinspx" data-title="Add an Inspection">
	</div>
	
	<!--Synchronize-->
	<div data-role="view" data-layout="drawer-layout" id="drawer-sync" data-title="Synch with Server">
	</div>

<!-- Unused code -->
<div>
	<!--Map Layout-->
	<div data-role="layout" data-id="map-layout">
		<header data-role="header">
			<div data-role="navbar">
				<span data-role="view-title"></span>
				<a data-role="backbutton" data-align="left" data-icon="drawer-button">Back</a>
			</div>
		</header>
	</div>

	<!--Contacts-->
	<div data-role="view" data-layout="drawer-layout" id="drawer-contacts" data-title="Contacts">
		<ul class="filterList" data-role="listview" data-template="contact-template" data-source="contactDataSource">
		</ul>
	</div>
	<script>
		var contactDataSource = new kendo.data.DataSource ({
			transport: {
				read: {
					url: "data/MyInspections/temp/inspection00000.xml",
					dataType: "xml"
                }
            },
			schema: {
				type: "xml",
				data: "/Inspection/Document/Contacts/Contact",
				model: {
					fields: {
						name:	   "Name/text()",
						unitNumber: "UnitNumber/text()",
						province:   "Province/text()",
						postalCode: "PostalCode/text()"
                    }
                }
            }
        })
		contactDataSource.fetch();
    </script>
	<script type="text/x-kendo-template" id="contact-template">
		<p data-icon="contacts">
			<span class="idetail-d"> #= name # </span>
			<span class="idetail-d"> #= (unitNumber === undefined) ? '' : unitNumber #   </span>
			<span class="idetail-d"> #= province #   </span>
			<span class="idetail-d"> #= postalCode #   </span>
		</p>
	</script>

	<!--Search-->
	<div data-role="view" data-layout="drawer-layout" id="drawer-search" data-title="Search">
		<ul data-role="listview">
			<li>90% Discount!</li>
			<li>90% Discount!</li>
			<li>One time offer!</li>
		</ul>
		<a data-role="button" style="background-color: darkred; display: block; margin: 2em; font-size: 1.4em;">
			Sync with server
		</a>
	</div>
</div>		
</body>
</html>
